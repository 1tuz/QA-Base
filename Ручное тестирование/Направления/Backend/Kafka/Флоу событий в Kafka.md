#kafka #кафка #бррокер_сообщений

1. **Продюсер** отправляет сообщение в **топик**, опционально указывая **ключ (Key)**.
   - Ключ используется для определения партиции, куда попадет сообщение (через хэширование)
   - Позволяет группировать связанные сообщения в одной партиции
   - Может быть любого типа данных (string, integer и т.д.)
   - Если ключ не указан, Kafka использует **round-robin** для распределения по партициям

2. **Брокер Kafka** сохраняет сообщение:
   - В конкретную партицию (по ключу или по кругу)
   - Гарантирует порядок сообщений внутри партиции
   - Назначает каждому сообщению уникальный offset

3. **Консюмер** из группы:
   - Читает сообщения из партиций
   - Отслеживает позицию через offset
   - Каждая партиция читается только одним консюмером в группе
   - [[Group ID]]

4. **Обработка**:
   - Выполняется бизнес-логика приложения
   - Возможно параллельное выполнение

5. **Коммит offset**:
   - Автоматически или вручную
   - Фиксирует прогресс обработки
   - Важен для гарантий доставки [[Гарантии доставки в Kafka]]

6. **Повторная обработка**:
   - При сбое до коммита
   - Kafka обеспечивает at-least-once доставку

[[Связь с брокерами]]